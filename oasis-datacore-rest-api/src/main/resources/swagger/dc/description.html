<!--  
 doc, with mini online playground using swagger.js client
 see http://developers-blog.helloreverb.com/the-fastest-way-to-connect-to-an-api-with-javascript/

 TODO rather using templating (through JAXRS providers) ?? ex. handlebars.js like Atol,
 see https://github.com/pole-numerique/oasis/blob/master/oasis-webapp/src/main/java/oasis/web/view/HandlebarsBodyWriter.java
 -->

<script type="text/javascript">
var containerUrl = "${datacoreApiServer.containerUrl}";
var baseUrl = "${datacoreApiServer.baseUrl}";
</script>

Allows to manage (CRUD) and find Data Resources and their Models using JSON/HTTP REST calls.
<br/><br/>
&nbsp;&nbsp;- <b>Data Resources</b> are handled in <a href="http://json-ld.org/">JSON-LD</a>-like 
(implicit context) format (see also <a href="http://json-ld.org/playground/index.html">
playground</a>) and with <b>W3C LDP</b> (Linked Data Platform, see 
<a href="https://dvcs.w3.org/hg/ldpwg/raw-file/tip/ldp-primer/ldp-primer.html">primer</a> and 
<a href="http://www.w3.org/2012/ldp/wiki/Main_Page">wiki</a>)-like operations (URIs, 
future collection filtering (<a href="http://www.w3.org/2012/ldp/wiki/LDPNext">1</a>, 
<a href="http://lists.w3.org/Archives/Public/public-ldp-wg/2012Dec/0030.html">2</a>)
-inspired finders etc.). <b>Have a look at existing Resources, at</b> 
<a href="/dc/type/pli:city_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/pli:city_0</a> for instance for resources in the 
<span class="dcjsonline">
pli:city_0</span> Model type (meaning version 0 of the pli:city Model). 
In addition to the simpler default native pure JSON format, "true" JSON-LD formats and semantic web formats (such as 
<a href="http://en.wikipedia.org/wiki/Resource_Description_Framework">RDF</a>, see 
<a href="/dc/type/pli:city_0" class="dclink" onclick="
javascript:return findDataByTypeRdf($(this).attr('href'));
">example</a>) are available. 
<br/><br/>
&nbsp;&nbsp;- <b>Data Models</b> describe what kinds of Data Resources are allowed in a 
<a href="http://json-schema.org/">JSON Schema</a>-like structure (see 
<a href="http://jsonschema.net/">jsonschema.net playground</a>) with 
<span class="dcjsonline">
string, boolean, int, float, long, double, date, map, list, i18n, resource
</span> fields grouped in reusable <b>Mixin</b> types. 
<b>Have a look at known Models at</b> <a href="/dc/type/dcmo:model_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/dcmo:model_0</a> and Mixins at <a href="/dc/type/dcmi:mixin_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/dcmi:mixin_0</a>, 
in their own metamodel where they may be drafted, published (<b>upcoming</b>) and queried as Resources. 
This allows to know in which Model types a given kind of Resources can be queried, for instance :
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <a href="/dc/type/dcmo:model_0?dcmo:globalMixins=pl:place_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">dcmo:globalMixins=pl:place_0</a> : lists Models that describe a location i.e. have a pl:shape WKS point, 
such as : 
<a href="/dc/type/dcmo:model_0/co:company_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">co:company_0</a>, 
whose WKS can then be retrieved, for instance by 
GET <a href="/dc/type/co:company_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/co:company_0</a> .
<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;- <a href="/dc/type/dcmo:model_0?dcmo:globalFields.dcmf:name=plo:name" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">dcmo:globalFields.dcmf:name=plo:name</a> : lists Models that "officially" have a country 
(i.e. having the "official" field for a country in OASIS Datacore), and that can therefore be queried on that, 
such as : 
<a href="/dc/type/dcmo:model_0/plo:country_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">plo:country_0</a>, 
<a href="/dc/type/dcmo:model_0/pli:city_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">pli:city_0</a>, 
<a href="/dc/type/dcmo:model_0/co:company_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">co:company_0</a>, 
<a href="/dc/type/dcmo:model_0/cityareauseit:urbanAreaDestinationOfUse_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">cityareauseit:urbanAreaDestinationOfUse_0</a>, 
<a href="/dc/type/dcmo:model_0/cityarea:cityArea_0" class="dclink" onclick="
javascript:return getData($(this).attr('href'));
">cityarea:cityArea_0</a> , 
which can then be queried by country, for instance by 
GET <a href="/dc/type/plo:country_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/plo:country_0</a>, 
GET <a href="/dc/type/pli:city_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/pli:city_0</a>, 
GET <a href="/dc/type/co:company_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/co:company_0</a>, 
GET <a href="/dc/type/cityareauseit:urbanAreaDestinationOfUse_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/cityareauseit:urbanAreaDestinationOfUse_0</a> 
and GET <a href="/dc/type/cityarea:cityArea_0" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/cityarea:cityArea_0</a>.
<br/><br/>
<a href="https://github.com/pole-numerique/oasis-datacore/wiki">See wiki</a> for further 
examples, FAQ, how to & common use cases, cookbook (writing clients...) and full documentation.
<br/><br/>
<p>
<a name="mydata"/>
<span class="json dcjsonline">GET ${datacoreApiServer.baseUrl}<input type="text" id="myurl" class="myurl json dcjsonline" style="padding: 0; width: 550px"></span>
<button onclick="javascript:return findData($('.myurl').val());">go</button>
<button onclick="javascript:return setUrl('');">reset</button><br/>
<div class="block response_body">
<pre class="json dcjsonarea"><code id="mydata" class="mydata"></code></pre>
</div>
</p>
<p></p>
<p></p>
<b>This endpoint</b> has for base URL <a href="${datacoreApiServer.baseUrl}">${datacoreApiServer.baseUrl}</a> 
(URL that must be called by clients using HTTP) 
and for container URL <a href="${datacoreApiServer.containerUrl}">${datacoreApiServer.containerUrl}</a> 
(URL that must be used to build Datacore Data resource URIs).
<br/><br/>
<b>To add your own data</b> using REST calls, you must first define or reuse the appropriate business-specific Models.
You can do both using the <a href="./import/index.html">Import UI</a> (includes OpenElec sample), or using Java (see
<a href="https://github.com/pole-numerique/oasis-datacore/tree/master/oasis-datacore-rest-server/src/main/java/org/oasis/datacore/sample">
Provto sample</a>), or do it any other way that still follows the
<a href="https://github.com/pole-numerique/oasis-datacore/blob/master/oasis-datacore-rest-server/src/main/java/org/oasis/datacore/sample/DatacoreSampleMethodologyBase.java">
methodology</a>. Basically, this means :
provide a denormalized extract of your data, define Models for it, group related fields together in Mixins,
define their ID definition policy and link them using resource fields, define referencing mixin fields and default values,
find out which Models already exist and reconcile with them (or do it beforehands).
<br/><br/>
<b>To use it from your own business application,</b> use the JSON/HTTP client of your own business application's platform
and / or of your choice to call the Datacore API server using REST JSON/HTTP calls. See
<a href="https://github.com/pole-numerique/oasis-datacore/blob/master/README.md">README</a> for details on alternatives
(the Datacore CXF Java client, any other Java JAXRS-compatible client, swagger.js in javascript, swagger codegen in any other language).
<br/><br/>

<h1>Details</h1>
<b>URIs</b> that uniquely identify Datacore Data resource are in the form
<span class="dcjsonline">$containerUrl/dc/type/$type/$iri</span>, where 
$containerUrl is unique for a container (ex. http://data.oasis-eu.org), $type is 
among available model types and $iri is the resource's Internal Resource Identifier (IRI). 
<br/><br/>
&nbsp;&nbsp;- IRIs have 3 constraints : they must be valid URL endings, unique (not enforced yet), 
and if possible readable and representative of the resource.
<br/><br/>
&nbsp;&nbsp;- URIs must be <a href="http://perishablepress.com/stop-using-unsafe-characters-in-urls/">
valid URLs</a> i.e. non safe characters (beyond <span class="dcjsonline">[0-9a-zA-Z]$-_.+!*'()</span>
including reserved characters <span class="dcjsonline">$&+,/:;=?@</span>
<a href="http://blog.lunatech.com/2009/02/03/what-every-web-developer-must-know-about-url-encoding">
outside of their purpose</a> such as '?' within <span class="dcjsonline">$type</span>)
must be encoded, and it's bad practice for model names to contain some.<br/><br/>
&nbsp;&nbsp;- URIs of embedded Resources (as sub Resource within another top level Resource)
are by default <span class="dcjsonline">$containerUrl/dc/type/$subResourceType/$resourceIri/$subResourceJsonPath</span>,
but can be something else if parsing is defined consistently within $subResourceType.
<br/><br/>
<b>Values</b> are formatted in JSON as follows :
<br/><br/>
&nbsp;&nbsp;- <span class="dcjsonline">date</span> as <a href="http://en.wikipedia.org/wiki/ISO_8601">ISO8601</a>
such as <span class="dcjsonline">"2014-01-08T09:31:19.062Z"</span>, <span class="dcjsonline">"2014-01-08T10:31:19.062+01:00"</span>.
Put your (data or application) timezone in your dates so that they can be shared across the world while staying readable for your local use case.
<br/><br/>
&nbsp;&nbsp;- <span class="dcjsonline">long</span> and <span class="dcjsonline">double</span> as string
<br/><br/>
&nbsp;&nbsp;- <span class="dcjsonline">i18n</span> as a list of translation objects (like JSONLD), for instance :
<span class="dcjsonline">[{"v": "Torino", "l": "it"}, {"v": "Turin","l": "fr"}]</span>.
It allows language-agnostic lookups such as 
<a href="/dc/type/pli:city_0?pli:name_i18n.v=Torino" class="dclink" onclick="
javascript:return findDataByType($(this).attr('href'));
">/dc/type/pli:city_0?pli:name_i18n.v=Torino</a>
, but also language-scoped lookups such as
<a href="#" class="dclink" onclick="
javascript:return findDataByType($(this).text());
">/dc/type/pli:city_0?pli:name_i18n=$elemMatch{"v":"Torino","l":"it"}</a>
<br/><br/>
<b>Operations</b> where type of data is provided in URL are usually more efficient : 
'*inType' methods are faster, finder queries with type even more.
<br/><br/>
<strong>WARNING</strong> Swagger UI has some limitations (but not other HTTP clients) :
<br/>&nbsp;&nbsp;- it encodes path parameters, so type & IRI will be wrong if they have 
encodable characters (ex. slash in IRI).
<br/>&nbsp;&nbsp;- it weirdly encodes query parameter values, notably '+' as space (which 
is especially annoying when specifying ASC order in Datacore queries). It probably has to do 
<a href="http://stackoverflow.com/questions/2678551/when-to-encode-space-to-plus-or-20">
with application/x-www-form-encoded encoding</a>.
<br/><br/>
<strong>Authentication:</strong>
<br/>&nbsp;&nbsp;- In production (and integration), OASIS Kernel OAuth2 authentication must be used, i.e. 
<a href="https://github.com/pole-numerique/oasis-datacore/wiki/How-to-use-OAuth2-with-Datacore">
HTTP requests' Authorization header must be "Bearer &lt;base 64-encoded valid OAuth2 Bearer 
/ Access Token&gt;"</a> (see <a href="https://github.com/pole-numerique/oasis-datacore/wiki/How-to-authenticate-to-kernel-oauth2">how to get one</a>).
<br/>&nbsp;&nbsp;- In dev mode, there is a mock authentication system that supports Basic Auth 
(i.e. HTTP requests' Authorization header must be "Basic &lt;base 64-encoding of username:password&gt;"), 
for a few users without password, see available ones in 
<a href="https://github.com/pole-numerique/oasis-datacore/blob/master/oasis-datacore-rest-server/src/main/resources/oasis-datacore-security-mock-context.xml">
configuration</a>.
<br/>&nbsp;&nbsp;- Datacore API's Swagger UI allows to provide said Authorization header, 
with a default value that logs as admin in dev mode.
<br/><br/>
<strong>This server's configuration:</strong>
<pre><code>
## Development mode (also allows to set system property datacore.dropdb=true ex. in maven)
datacore.devmode=${datacore.devmode}

## Other (or all) known Datacores (comma-separated container URLs)
datacoreApiServer.knownDatacoreContainerUrls=${datacoreApiServer.knownDatacoreContainerUrls}

## Query :
## default maximum number of documents to scan when fulfilling a query, overriden by
## DCFields', themselves limited by DCModel's. 0 means no limit (for tests), else ex.
## 1000 (secure default), 100000 (on query-only nodes using secondary & timeout)... 
## http://docs.mongodb.org/manual/reference/operator/meta/maxScan/
datacoreApiServer.query.maxScan=${datacoreApiServer.query.maxScan}
## default maximum start position
datacoreApiServer.query.maxStart=${datacoreApiServer.query.maxStart}
## default maximum number of documents returned
datacoreApiServer.query.maxLimit=${datacoreApiServer.query.maxLimit}

## Kernel Configuration
kernel.baseUrl=${kernel.baseUrl}
</code></pre>
